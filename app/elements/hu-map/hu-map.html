<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/google-map/google-map.html">
<link rel="import" href="../api-ajax/api-ajax.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<!-- <link rel="import" href="../../bower_components/google-map-markerclusterer/google-map-markerclusterer.html"> -->
<link rel="import" href="../../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../hu-list/hu-list.html">
<link rel="import" href="../../bower_components/core-drawer-panel/core-drawer-panel.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/core-field/core-field.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">

<polymer-element name="hu-map" attributes="">
  <template>
    <style>
      :host {
        display: block;
      }
      google-map {
        padding-top:16px;
        display: block;
        height: 800px;
      }
      paper-button{
        margin-top:8px;
        margin-bottom:8px;
      }

      paper-toggle-button{

      }
      .item.core-selected {
        background: #eee;
      }
      core-selector{
        height:800px;
        position:absolute;
        left:16px;
        width:200px;
        z-index:10;

      }
      [drawer] {
        background-color: #fff;
      }

      [main] > div {
        padding: 2em;
      }

      [drawer] > core-item {
        padding: 1em;
      }

      [main] paper-checkbox {
        margin-right: 1em;
      }

      [main] {
        height: 100%;
        background-color: #f1f1f3;
      }

      [drawer] core-toolbar {
        background-color: #4F7DC9;
        color: #fff;
      }

      [main] core-toolbar {
        background-color: #526E9C;
        color: #fff;
      }
      #inputs {
        position: absolute;
        bottom: 25px;
        right: 25px;
        z-index: 100;
      }

      core-field {
        background: #fff;
        border-radius: 3px;
        margin-top: 5px;
        width: 200px;
      }

      core-field core-icon {
        vertical-align: middle;
      }
      core-header-panel{
        background-color:rgbs(120,120,120,.5);
      }
      core-drawer-panel{
        z-index:10;
      }
    </style>

    <core-drawer-panel id="drawerpanel"
      responsiveWidth="600px">

      <core-header-panel drawer layout horizontal center>
        <paper-button index="0" on-tap="{{clickHandler}}" raised>ALL </paper-button>
        <paper-button index="1" on-tap="{{clickHandler}}" raised>MAIN CAMPUS</paper-button>

        <paper-button index="2" on-tap="{{clickHandler}}" raised>EAST CAMPUS</paper-button>

        <paper-button index="3" on-tap="{{clickHandler}}" raised>WEST CAMPUS</paper-button>

        <paper-button index="4" on-tap="{{clickHandler}}" raised>PARKING</paper-button>

        <paper-button index="5" on-tap="{{clickHandler}}" raised>RESIDENCE HALLS</paper-button>

        <paper-button index="6" on-tap="{{clickHandler}}" raised>DINING</paper-button>

        <paper-button index="7" on-tap="{{clickHandler}}" raised>BLUE LIGHTS</paper-button>

        <paper-button index="8" on-tap="{{clickHandler}}" raised>BISON ONE CARD</paper-button>
      </core-header-panel>

      <core-header-panel main>
        <core-toolbar>
          <paper-icon-button icon="menu"
            on-click="{{toggleDrawer}}"></paper-icon-button>
          <span flex>HU MAPS</span>
          <paper-icon-button icon="search"></paper-icon-button>
          <paper-icon-button icon="more-vert"></paper-icon-button>
        </core-toolbar>
        <div class="content">
          <google-map
            id="humap"
            apiKey="{{apiKey}}"
            map="{{map}}"
            latitude="38.922684" longitude="-77.019438"
            zoom="16"
            maxzoom="16"
            minZoom="16"
            disableDefaultUI>
          <template repeat = "{{bldg in bldgs}}">
              <google-map-marker id="{{bldg.image_url}}"
              latitude="{{bldg.lat}}"
              longitude="{{bldg.lon}}"
              icon="../../images/icon/{{bldg.image_url || 'college'}}-24@2x.png"
              title="{{bldg.building_name}}"
              hidden?="{{bldg.image_url!=categorySelected && categorySelected!='all'}}">

              <h3>{{bldg.campus_name}}({{bldg.campus_id}})</h3>
              <h3>{{bldg.building_name}}({{bldg.building_id}})</h3>
              <p>
                {{bldg.building_address}}
              </p>
            </google-map-marker>
          </template>
      </google-map>



        </div>
      </core-header-panel>

    </core-drawer-panel>

    <div id="inputs">
      <core-field>
        <core-icon icon="icons:search"></core-icon>
        <input placeholder="Start address" value="San Francisco">
      </core-field>
      <core-field>
        <core-icon icon="icons:search"></core-icon>
        <input placeholder="End address" value="Mountain View">
      </core-field>
    </div>

    <!--
    CONTAINAER FOR THE LIST COMPONENTS-->
    <hu-list id="hu_list"
      bldgs="{{bldgs}}"
      categoryselected="{{categorySelected}}">

      <hu-card>

      </hu-card>

    </hu-list>






    <api-ajax bldgs = "{{bldgs}}"></api-ajax>






  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        // @TODO ADD FUNCTION TO FILTER THE LIST COMPONENTS BY WHAT IS CONTAINED INSIDE THEM
        toggleButton:function(){

        },
        isParking:function(idname){
          if(parseInt(idname)){
            return true;
          }else{
            return false;
          }
        },
        ready:function(){

          this.categorySelected='all';
          this.apiKey = "AIzaSyAQ8fwfkyjhln59a2ODNDNF2f6lXZhA_aU";
          this.mapStyle = [
            {"elementType":"labels.icon","stylers":[{"color":"#365779"},{"visibility":"off"}]}
            ,{"featureType":"landscape","stylers":[{"color":"#042E58"}]}
            ,{"featureType":"road.highway","stylers":[{"color":"#A51A1D"}]}
            ,{"featureType":"road.local","stylers":[{"color":"#808080"},{"visibility":"off"}]}
            ,{"featureType":"road.arterial","stylers":[{"color":"#808080"},{"visibility":"off"}]}
            ,{"elementType":"labels.text","stylers":[{"color":"#ffffff"},{"weight":0.1}]}
            ,{"featureType":"poi","stylers":[{"color":"#365779"}]}
            ,{"featureType":"poi","elementType":"labels.text","stylers":[{"color":"#ffffff"}]}
            ,{"featureType":"water"}
            ,{"featureType":"transit","stylers":[{"color":"#365779"}]}];
        },
        domReady:function(){

        },
        mapReady:function(){
          console.log("map ready");
          // console.log(this.$.humap.map);

        },
        toggleDrawer:function(){
          this.$.drawerpanel.togglePanel();
        },
        /**
         * THIS FUNCTION IS THE SOLE HANDLER FOR ALL 8 PAPER-BUTTONS
         * @TODO  CALL A METHOD ON THE LIST COMPONENT THAT FILTERS ITSELF BY
         *        BUILDING ID WHICH IS PASSED IN BY THIS
         */
        clickHandler:function(e,detail,sender){
          var filter = e.target.innerText
          console.log("click");
          var markers = this.$.humap.querySelectorAll('google-map-marker');
          switch (filter) {
            case "ALL":
              console.log("ALL button clicked");
              this.categorySelected='all'
              break;
            case "MAIN CAMPUS":
              console.log("MAIN CAMPUS button clicked");
              break;
              case "EAST CAMPUS":
                console.log("EAST CAMPUS button clicked");
                break;
                case "WEST CAMPUS":
                  console.log("WEST CAMPUS button clicked");
                  break;
                  case "PARKING":
                    this.categorySelected='parking';
                    console.log("PARKING button clicked");
                    break;
                    case "RESIDENCE HALLS":
                      this.categorySelected='residence';
                      console.log("RESIDENCE HALLS button clicked");
                      break;
                      case "DINING":
                        console.log("DINING button clicked");
                        break;
                        case "BLUE LIGHTS":
                          console.log("BLUE LIGHTS button clicked");
                          break;
                          case "BISON ONE CARD":
                            console.log("BISON ONE CARD button clicked");
                            break;
                            default:
                              console.log("Sorry");
                            }
        },
        bldgsChanged:function(attrName,oldVal,newVal){
          console.log("bldgs attr changed");
        }
      });

    })();
  </script>
</polymer-element>
